--Arreglar problema de Transoid
--buscar el cliente en el modulo de cuentas por cobrar - consiltas - consulta factura cliente  y poner el cod_cli en el filtro
--revisar las facturas que estan pagadas y coger como referencia el numero de documento eje PP02213550
--restablecer el saldo de las facturas generadas deben ser de igual numero que las planillas eje 3 pp = 3 planillas
--restablecer saldo del ingreso que fue afectado por las pp (restar el valor total de las pp) en la cabecera.
--eliminar del detalle las pp




SELECT cxc_corrida, * FROM etes.manifiesto_carga WHERE planilla IN ('0240732','0240726','0240520','0240524','0240349','0240348');    --cxc_corrida = 'R0037033';
SELECT * FROM con.factura WHERE ref2 IN ('0240520',
'0240524',
'0240586',
'0240583',
'0240517',
'0240582',
'0240519',
'0240516',
'0240523',
'0240726',
'0240732',
'0240527',
'0240587',
'0240589',
'0240530',
'0240529',
'0240182',
'0240186',
'0240183',
'0240188',
'0240184',
'0240347',
'0240349',
'0240423',
'0240585',
'0240398',
'0240350',
'0240352',
'0240355',
'0240358',
'0240356',
'0240522',
'0240526',
'0240525',
'0240579',
'0240575',
'0240573',
'0240421',
'0240391',
'0240405',
'0240400',
'0240359',
'0240437',
'0240408',
'0240348',
'0240532',
'0240351');

-- desmarcar las planillas (buscar por la R que sale en la visualizacion de la corrida de UT primero y de ese select sacar las pp q estan con el usuario
-- de MMUSKUS);
SELECT cxc_corrida, * FROM etes.manifiesto_carga 
-- UPDATE etes.manifiesto_carga SET cxc_corrida = ''
WHERE planilla IN ('0240520',
'0240524',
'0240586',
'0240583',
'0240517',
'0240582',
'0240519',
'0240516',
'0240523',
'0240726',
'0240732',
'0240527',
'0240587',
'0240589',
'0240530',
'0240529',
'0240182',
'0240186',
'0240183',
'0240188',
'0240184',
'0240347',
'0240349',
'0240423',
'0240585',
'0240398',
'0240350',
'0240352',
'0240355',
'0240358',
'0240356',
'0240522',
'0240526',
'0240525',
'0240579',
'0240575',
'0240573',
'0240421',
'0240391',
'0240405',
'0240400',
'0240359',
'0240437',
'0240408',
'0240348',
'0240532',
'0240351'); 

--RESTABLECER SALDO DE LAS FACTURAS
UPDATE con.factura AS a SET valor_abonome =  0 , valor_saldome = b.valor_saldo
FROM (SELECT * FROM con.factura 
WHERE documento in ('PP02216018',
'PP02216019',
'PP02216020',
'PP02216021',
'PP02216022',
'PP02216023',
'PP02216024',
'PP02216025',
'PP02216026',
'PP02216027',
'PP02216028',
'PP02216300',
'PP02216226',
'PP02216228',
'PP02215799',
'PP02215794',
'PP02215801',
'PP02215800',
'PP02215795',
'PP02216029',
'PP02216250',
'PP02216251',
'PP02216252',
'PP02216253',
'PP02216254',
'PP02216255',
'PP02216256',
'PP02216257',
'PP02216258',
'PP02216259',
'PP02216260',
'PP02216261',
'PP02216262',
'PP02216263',
'PP02216264',
'PP02216265',
'PP02216266',
'PP02216267',
'PP02216268',
'PP02216269',
'PP02216270',
'PP02216282',
'PP02216301') ) AS B WHERE  a.documento =b.documento;


--RESTABLECER SALDO DE LA CABECERA DEL INGRESO
SELECT * FROM con.ingreso WHERE num_ingreso = 'IA536076'; -- select 161746935 - 10496117 = 151250818
SELECT * FROM con.ingreso_detalle WHERE num_ingreso = 'IA536076';


-- DELETE PP DEL DETALLE DEL INGRESO
CREATE TABLE tem.ingr_IA536076 AS
SELECT * FROM con.ingreso_detalle 
--delete from con.ingreso_detalle
WHERE num_ingreso = 'IA536076' AND 
documento in ('PP02216018',
'PP02216019',
'PP02216020',
'PP02216021',
'PP02216022',
'PP02216023',
'PP02216024',
'PP02216025',
'PP02216026',
'PP02216027',
'PP02216028',
'PP02216300',
'PP02216226',
'PP02216228',
'PP02215799',
'PP02215794',
'PP02215801',
'PP02215800',
'PP02215795',
'PP02216029',
'PP02216250',
'PP02216251',
'PP02216252',
'PP02216253',
'PP02216254',
'PP02216255',
'PP02216256',
'PP02216257',
'PP02216258',
'PP02216259',
'PP02216260',
'PP02216261',
'PP02216262',
'PP02216263',
'PP02216264',
'PP02216265',
'PP02216266',
'PP02216267',
'PP02216268',
'PP02216269',
'PP02216270',
'PP02216282',
'PP02216301'); 
